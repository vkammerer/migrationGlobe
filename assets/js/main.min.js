!function(){"use strict";var e=function(e){var e=e||{},t=e.radius||200,i=e.widthSegments||40,n=e.heightSegments||30,o=e.texture||"assets/img/world.jpg",a=THREE.ImageUtils.loadTexture(o),r=e.material||new THREE.MeshBasicMaterial({map:a}),s=new THREE.SphereGeometry(t,i,n),d=new THREE.Mesh(s,r);return d.rotation.y=Math.PI,d};window.Globe=e}(),function(){"use strict";var e=function(e){this.mesh=e};e.prototype.quadraticFlux=function(e,t,i,n){var o=this.coordToPoint(e,t,this.mesh.geometry.radius),a=this.coordToPoint(i,n,this.mesh.geometry.radius),r=o.clone().sub(a).length(),s=this.midCoord(e,t,i,n),d=this.coordToPoint(s.latitude,s.longitude,this.mesh.geometry.radius);d.normalize(),d.multiplyScalar(this.mesh.geometry.radius+.5*r);var u=new THREE.LineBasicMaterial({color:"white",linewidth:1}),l=new THREE.QuadraticBezierCurve3(o,d,a),c=new THREE.CurvePath;c.add(l);var h=c.createPointsGeometry(100),m=new THREE.Line(h,u);return m},e.prototype.cubicFlux=function(e,t,i,n){var o=this.coordToPoint(e,t,this.mesh.geometry.radius),a=this.coordToPoint(i,n,this.mesh.geometry.radius),r=o.clone().sub(a).length(),s=o.clone().sub(this.mesh.position);s.normalize(),s.multiplyScalar(r),s.add(o);var d=a.clone().sub(this.mesh.position);d.normalize(),d.multiplyScalar(r),d.add(a);var u=new THREE.LineBasicMaterial({color:"red",linewidth:1}),l=new THREE.CubicBezierCurve3(o,s,d,a),c=new THREE.CurvePath;c.add(l);var h=c.createPointsGeometry(100),m=new THREE.Line(h,u);return m},e.prototype.doubleCubicFlux=function(e,t,i,n){var o=this.coordToPoint(e,t,this.mesh.geometry.radius),a=this.coordToPoint(i,n,this.mesh.geometry.radius),r=o.clone().sub(a).length(),s=this.midCoord(e,t,i,n),d=this.coordToPoint(s.latitude,s.longitude,this.mesh.geometry.radius);d.normalize(),d.multiplyScalar(this.mesh.geometry.radius+.2*r);var u=o.clone().sub(a);u.normalize();var l=d.clone().add(u.clone().multiplyScalar(r/2)),c=d.clone().add(u.clone().multiplyScalar(-r/2)),h=new THREE.CubicBezierCurve3(o,o,l,d),m=new THREE.CubicBezierCurve3(d,c,a,a),E=h.getPoints(50);E=E.splice(0,E.length-1),E=E.concat(m.getPoints(50));var w=new THREE.Geometry;w.vertices=E;var g=new THREE.LineBasicMaterial({color:"blue",linewidth:1}),p=new THREE.Line(w,g);return p},e.prototype.coordToPoint=function(e,t,i){var n=(90-e)*Math.PI/180,o=(180-t)*Math.PI/180,a=new THREE.Vector3;return a.x=i*Math.sin(n)*Math.cos(o),a.y=i*Math.cos(n),a.z=i*Math.sin(n)*Math.sin(o),a},e.prototype.midCoord=function(e,t,i,n){var o=e*Math.PI/180,a=t*Math.PI/180,r=i*Math.PI/180,s=(n-t)*Math.PI/180,d=Math.cos(r)*Math.cos(s),u=Math.cos(r)*Math.sin(s),l=Math.atan2(Math.sin(o)+Math.sin(r),Math.sqrt((Math.cos(o)+d)*(Math.cos(o)+d)+u*u)),c=a+Math.atan2(u,Math.cos(o)+d);return c=(c+3*Math.PI)%(2*Math.PI)-Math.PI,{latitude:180*l/Math.PI,longitude:180*c/Math.PI}},window.Flux=e}(),function(){"use strict";function e(){o=document.getElementById("container");var e=window.innerWidth,i=window.innerHeight;r=new THREE.PerspectiveCamera(45,e/i,1,2e3),r.position.z=1500,s=new THREE.OrbitControls(r),s.minDistance=500,s.maxDistance=2e3,s.addEventListener("change",n),a=new Stats,document.body.appendChild(a.domElement),u=new THREE.WebGLRenderer({antialias:!0}),u.setSize(e,i),u.domElement.style.position="absolute",o.appendChild(u.domElement),d=new THREE.Scene,d.fog=new THREE.Fog(1118481,1800,2e3),window.addEventListener("resize",t,!1);var l=new Globe({texture:"assets/img/world_4k.jpg"});d.add(l);var c=new Flux(l),h={latitude:47.21176,longitude:-1.573},m=new XMLHttpRequest;m.open("GET","assets/data/capitals.json",!0),m.onreadystatechange=function(){if(4===m.readyState&&200===m.status)for(var e,t=JSON.parse(m.responseText),i=0;5>i;i++){e=t[i],console.log(e.capital);var o=c.quadraticFlux(h.latitude,h.longitude,e.latitude,e.longitude),a=c.cubicFlux(h.latitude,h.longitude,e.latitude,e.longitude),r=c.doubleCubicFlux(h.latitude,h.longitude,e.latitude,e.longitude);d.add(o),d.add(a),d.add(r),n()}},m.send(null)}function t(){r.aspect=window.innerWidth/window.innerHeight,r.updateProjectionMatrix(),u.setSize(window.innerWidth,window.innerHeight),n()}function i(){requestAnimationFrame(i),s.update()}function n(){u.render(d,r),a.update()}Detector.webgl||Detector.addGetWebGLMessage();var o,a,r,s,d,u;e(),i()}();